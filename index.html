<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grounded AI Research Assistant (Modular)</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Slate 50 */
        }
    </style>
</head>
<body class="min-h-screen p-4 sm:p-8">

    <div id="app" class="max-w-3xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-4xl font-extrabold text-blue-800 tracking-tight mb-2">
                Grounded AI Assistant
            </h1>
            <p class="text-blue-600 text-lg font-medium">
                Uses Google Search to ground answers in real-time data.
            </p>
        </header>

        <!-- System Prompt Control (NEW SECTION) -->
        <div class="bg-gray-100 p-4 rounded-xl shadow-inner mb-6">
            <label for="system-prompt-input" class="block text-sm font-bold text-gray-700 mb-2">
                System Prompt (AI Persona):
            </label>
            <textarea
                id="system-prompt-input"
                rows="3"
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-400 focus:border-blue-400 text-sm resize-none"
                title="Define the AI's role, tone, and format here."
            >You are a professional research assistant. Provide a concise, highly factual, and single-paragraph summary of the key information requested by the user. Ensure accuracy and currency using grounding sources.</textarea>
        </div>
        
        <!-- Main Query Interface -->
        <div class="bg-white p-6 rounded-xl shadow-2xl border border-gray-100">
            <form id="ai-form" class="flex flex-col gap-4">
                <textarea
                    id="user-query"
                    rows="4"
                    placeholder="Ask a factual question (e.g., 'What were the latest earnings for Google this quarter?')"
                    required
                    class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-base transition duration-150 ease-in-out resize-none"
                ></textarea>
                <button
                    type="submit"
                    id="submit-button"
                    class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-200 ease-in-out transform hover:scale-[1.005] active:scale-[0.99] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:bg-gray-400 disabled:cursor-not-allowed"
                >
                    Get Grounded Answer
                </button>
            </form>
        </div>

        <!-- Response Area -->
        <div id="response-container" class="mt-8">
            <h2 id="response-title" class="text-2xl font-bold text-gray-800 mb-4 hidden">
                AI Response
            </h2>
            
            <!-- Loading and Error Display -->
            <div id="loading-indicator" class="hidden text-center p-8 bg-blue-50 rounded-xl shadow-lg border-2 border-blue-200">
                <svg class="animate-spin h-6 w-6 text-blue-600 mx-auto mb-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                <p class="text-blue-700 font-medium">Querying the model and external data...</p>
            </div>
            <div id="error-message" class="hidden text-center p-4 bg-red-100 rounded-xl shadow border border-red-400 text-red-700"></div>

            <!-- AI Output -->
            <div id="ai-output" class="bg-white p-6 rounded-xl shadow-lg transition-all duration-300 hidden">
                <p id="ai-text" class="text-gray-700 leading-relaxed whitespace-pre-wrap"></p>
                
                <!-- Sources Area -->
                <div id="sources-area" class="mt-6 pt-4 border-t border-gray-200 hidden">
                    <p class="text-sm font-semibold text-gray-600 mb-2">Sources Referenced:</p>
                    <ul id="source-list" class="space-y-1">
                        <!-- Sources injected here -->
                    </ul>
                </div>
            </div>
        </div>

    </div>

    <!-- Load the main application module -->
    <script type="module" src="./js/main.js"></script>
</body>
</html>
